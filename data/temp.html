<!DOCTYPE html>
<html lang = "en">
<head>
  <title> temp</title>
  <script src = "https://d3js.org/d3.v4.min.js"></script>
</head>


<style> /* set the CSS */
  
  
  
  div.tooltip {
    position: absolute;
    text-align: center;
    width: 60px;
    height: 28px;
    padding: 2px;
    font: 12px sans-serif;
    background: lightsteelblue;
    border: 0px;
    border-radius: 8px;
    pointer-events: none;
  }
  
</style>





<body>
  <h1> title</h1>
  <svg width="800" height="800"></svg>
  <script>
    
    var div = d3.select("body").append("div")
    .attr("class", "tooltip")
    .style("opacity", 0);
    
    
    var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height"),
    width = 0.8*width;
    height = 0.8*height;
    var margin = {top: (0.1*width), right: (0.1*width), bottom: (0.1*width), left: (0.1*width)};
    
    // create a clipping region 
    svg.append("defs").append("clipPath")
    .attr("id", "clip")
    .append("rect")
    .attr("width", width)
    .attr("height", height);
    
    
    
    //Read the data
    d3.csv("TopCharts_clustered.csv", function(data) {
      data.forEach(function(d) {
        d.pc1 = +d.pc1;
        d.pc2 = +d.pc2;
        d.Label = +d.Label
      });
      
      var pc1_max = 1.1*d3.max(data, function(d){return d.pc1;});
      var pc1_min = 1.1*d3.min(data, function(d){return d.pc1;});
      
      var pc2_max = 1.1*d3.max(data, function(d){return d.pc2;});
      var pc2_min = 1.1*d3.min(data, function(d){return d.pc2;});
      
      var color = d3.scaleOrdinal()
      .domain([0,1,2,3,4])
      .range(["#1077b3","#f56c0a","#207537","#d11515", "#a300cc"]);
      var radius = 3.5;
      
      var xAxisScale = d3.scaleLinear()
      .domain([pc1_min, pc1_max])
      .range([ 0, width ]);
      var xAxis = d3.axisBottom(xAxisScale);
      
      var yAxisScale = d3.scaleLinear()
      .domain([pc2_min, pc2_max])
      .range([ height, 0]);
      var yAxis = d3.axisLeft(yAxisScale);
      
      var gX = svg.append('g')
      .attr('transform', 'translate(' + margin.left + ',' + (margin.top + height) + ')')
      .call(xAxis);
      var gY = svg.append('g')
      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')
      .call(yAxis);
      
      var points_g = svg.append("g")
      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')
      .attr("clip-path", "url(#clip)")
      .classed("points_g", true);
      
      
      var points = points_g.selectAll("circle").data(data);
      points = points
      .enter()
      .append("circle")
      .attr("cx", function (d) { return xAxisScale(d.pc1); } )
      .attr("cy", function (d) { return yAxisScale(d.pc2); } )
      .attr("r", radius)
      .style("fill", function(d){return color(d.Label)})
      .on("mouseover", function(d) {
        div.transition()
        .duration(200)
        .style("opacity", .9);
        div.html(d.Title + "<br/>" + d.Artist)
        .style("left", d3.select(this).attr("cx") + "px")     
        .style("top", d3.select(this).attr("cy") + "px");
      })
      .on("mouseout", function(d) {
        div.transition()
        .duration(500)
        .style("opacity", 0);
      });
      
      var zoom = d3.zoom()
      .scaleExtent([.5, 20])
      .extent([[0, 0], [width, height]])
      .on("zoom", zoomed);
      
      svg.append("rect")
      .attr("width", width)
      .attr("height", height)
      .style("fill", "none")
      .style("pointer-events", "all")
      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')
      .call(zoom);
      
      
      
      function zoomed() {
        // create new scale ojects based on event
        var new_xScale = d3.event.transform.rescaleX(xAxisScale);
        var new_yScale = d3.event.transform.rescaleY(yAxisScale);
        // update axes
        gX.call(xAxis.scale(new_xScale));
        gY.call(yAxis.scale(new_yScale));
        points.data(data)
        .attr('cx', function(d) {return new_xScale(d.pc1)})
        .attr('cy', function(d) {return new_yScale(d.pc2)});
      }
      
      
      
      
    })
    
    
  </script>
  
</body>
</html>